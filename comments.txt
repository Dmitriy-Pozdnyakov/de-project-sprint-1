Анастасия, добрый день!

Спасибо за функцию NTILE - возьму на вооружение в в дальнейшем. 
Не знаком со всеми оконными функциями, т.к. работаю в SAS EG более 5 лет (в нем не классический sql), и в нем они отсутствуют.
create or replace view - скорректировал.
по insert into, постараюсь перестроиться в будущем, но это будет тяжело, т.к. я слежу за содержимым select, который привносит новые данные.

Хотел спросить:
1. На практике хороший ли тон использовать кастомные функции при написании сложных проектов?
2. Когда создаются view, есть ли какой-то общепринятый нейминг для представлений и материализованных представлений,
в работе часто сталкивался с такими вещами, что при ревью чужих скриптов непонятно ссылается сотрудник к вью или таблице?
3. Как работает доступ к представлениям, которые собраны из таблиц другой схемы, к которой у пользователя нет доступа, сможет ли он ими пользоваться?

Заранее благодарю за ответы.
Больше вопросов нет.
